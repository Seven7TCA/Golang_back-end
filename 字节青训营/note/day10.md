学习内容：「实践课 - 系统设计之秒杀系统」
- 系统设计方法论
- 电商秒杀业务介绍
- 课程实践

![代码](../code/h_promotion/h_promotion/src)

# 系统设计方法论

为什么要做系统设计
- 个人？
    - for 面试
    - 个人能力提升
    - 拓展技术视野
- 工作？
    - 业务驱动
    - 系统重构
    - 突破和创新

系统设计的概念是什么
- 系统
    - 关联的个体
    - 规则运作
    - 组成工作的整体
- 设计
    - 设想和计划
    - 目的
    - 过程安排
- 定义：为了达成某种目的，通过个体组成整体的过程

如何做系统设计：4S分析法
- 场景分析(Scenario)：什么系统，需要哪些功能，多大的并发量
- 存储设计 (Storage)：数据如何组织，Sql存储，NoSql存储
- 服务设计 (Service)：业务功能实现和逻辑整合
- 可扩展性(Scale)：解决设计缺陷，提高鲁棒性、扩展性

如何分析系统瓶颈和优化
- 火焰图分析
- 链路分析
- 全链路压测

如何验证系统的可用性和稳定性
- 链路梳理
    - 核心链路
    - 流量漏斗
    - 强弱依赖
- 可观测性
    - 链路追踪
    - 核心监控
    - 业务报警
- 全链路测试
    - 压力测试
    - 负载测试
    - 容量测试
- 稳定性控制
    - 系统限流
    - 业务兜底
    - 熔断降级
- 容灾演练
    - 混沌工程
    - 应急手册
    - 容灾预案

# 电商秒杀业务介绍

基本概念
- Spu（Standard Product Unit）：标准产品单元
- Sku（Stock Keeping Unit）：库存保管单位

秒杀业务的特点
- 瞬时流量高
- 读多写少
- 实时性要求高

秒杀的挑战
- 资源有限性
- 反欺诈
- 高性能
- 防止超卖
- 流量管控
- 扩展性
- 鲁棒性（Robust）：在异常和危险情况下系统生存的能力

# 设计秒杀系统

## 4S分析

场景（Scenario）
- 功能:
    - 秒杀活动发布
    - 秒杀商品详情
    - 秒杀下单
- 并发
    - 万人参与秒杀
    - QPS 1w+
    - TPS 1k+

存储（Storage）：MySQL -> Redis -> Localcache

服务（Service）:
- 子服务
    - 用户服务
    - 风控服务
    - 活动服务
    - 订单服务
- 基础组件
    - ID生成器
    - 缓存组件
    - MQ组件
    - 限流组件

扩展（Scale）
![拓展](../assets/%E6%8B%93%E5%B1%95.png)

## 架构图

![架构图](../assets/%E7%A7%92%E6%9D%80%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84%E5%9B%BE.png)

# 课程实践

![流程图](../assets/%E7%A7%92%E6%9D%80%E6%B5%81%E7%A8%8B%E5%9B%BE.png)


